# TVSubscribe - ç”µè§†å‰§ç§å­è‡ªåŠ¨ä¸‹è½½å™¨

ä¸€ä¸ªç°ä»£åŒ–çš„ç”µè§†å‰§ç§å­è‡ªåŠ¨ä¸‹è½½å·¥å…·ï¼Œæ”¯æŒä» SpringSunday ç½‘ç«™æŸ¥è¯¢å¹¶ä¸‹è½½ç§å­ï¼Œæä¾›å®Œæ•´çš„Webç®¡ç†ç•Œé¢å’ŒCLIå‘½ä»¤è¡Œå·¥å…·ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ“º æ”¯æŒå¤šä¸ªç”µè§†å‰§è®¢é˜…ç®¡ç†
- â° å®šæ—¶è‡ªåŠ¨æ£€æŸ¥æ–°ç§å­
- ğŸ¯ æ”¯æŒä¸åŒåˆ†è¾¨ç‡é€‰æ‹© (2160P/1080P)
- ğŸ“¥ è‡ªåŠ¨ä¸‹è½½ç§å­æ–‡ä»¶
- ğŸŒ **å†…ç½®Webç®¡ç†ç•Œé¢** - åŸºäºVue 3 + Element Plusçš„ç°ä»£åŒ–ç®¡ç†ç•Œé¢
- ğŸ–¥ï¸ **CLIå‘½ä»¤è¡Œå·¥å…·** - å®Œæ•´çš„å‘½ä»¤è¡Œç®¡ç†åŠŸèƒ½

### æ™ºèƒ½åŠŸèƒ½
- ğŸ¤– **è‡ªåŠ¨è·å–ç”µè§†å‰§åç§°** - æ ¹æ®è±†ç“£IDè‡ªåŠ¨è·å–ä¸­æ–‡åç§°
- ğŸ“§ **å¾®ä¿¡é€šçŸ¥** - æ”¯æŒå¾®ä¿¡æ¶ˆæ¯æ¨é€é€šçŸ¥
- ğŸ”„ **é…ç½®çƒ­é‡è½½** - ä¿®æ”¹é…ç½®åè‡ªåŠ¨ç”Ÿæ•ˆ
- ğŸ“Š **å®æ—¶çŠ¶æ€ç›‘æ§** - HTTP APIæä¾›å®Œæ•´çš„çŠ¶æ€ä¿¡æ¯

### ç®¡ç†æ–¹å¼
- ğŸŒ **Webç•Œé¢ç®¡ç†** - é€šè¿‡æµè§ˆå™¨è®¿é—® http://localhost:8443
- ğŸ’» **å‘½ä»¤è¡Œç®¡ç†** - æ”¯æŒé…ç½®ç®¡ç†å’Œè®¢é˜…ç®¡ç†çš„å®Œæ•´CLI
- ğŸ”§ **APIæ¥å£** - RESTful APIæ”¯æŒç¬¬ä¸‰æ–¹é›†æˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç›´æ¥ä½¿ç”¨ï¼ˆæ¨èï¼‰

æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š

```bash
# ä¸‹è½½å¹¶è¿è¡Œ
./tvsubscribe

# è®¿é—®Webç®¡ç†ç•Œé¢
open http://localhost:8443
```

### 2. ä»æºç æ„å»º

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/pt-tools.git
cd pt-tools/tvsubscribe

# æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶
go build -o tvsubscribe cmd/*.go

# è¿è¡Œç¨‹åº
./tvsubscribe
```

## âš™ï¸ é…ç½®è¯´æ˜

### Webç•Œé¢é…ç½®

å¯åŠ¨ç¨‹åºåï¼Œè®¿é—® http://localhost:8443 è¿›å…¥Webç®¡ç†ç•Œé¢ï¼Œå¯ä»¥ï¼š

- ğŸ›ï¸ ç®¡ç†æœåŠ¡å™¨é…ç½®
- ğŸ“ æ·»åŠ /åˆ é™¤è®¢é˜…
- ğŸ“Š æŸ¥çœ‹å®æ—¶çŠ¶æ€
- âš™ï¸ è°ƒæ•´ç³»ç»Ÿå‚æ•°

### é…ç½®æ–‡ä»¶ç»“æ„

ç¨‹åºæ”¯æŒä»¥ä¸‹é…ç½®é€‰é¡¹ï¼š

```json
{
  "endpoint": "https://springsunday.net",
  "cookie": "your_springsunday_cookie",
  "interval_minutes": 60,
  "wechat_server": "your_wechat_server_url",
  "wechat_token": "your_wechat_token",
  "port": 8443
}
```

### é…ç½®å­—æ®µè¯´æ˜

- `endpoint`: SpringSunday ç½‘ç«™åœ°å€
- `cookie`: SpringSunday ç½‘ç«™çš„ç™»å½• Cookie
- `interval_minutes`: æ£€æŸ¥é—´éš”ï¼ˆåˆ†é’Ÿï¼‰ï¼Œé»˜è®¤ 60 åˆ†é’Ÿ
- `wechat_server`: å¾®ä¿¡é€šçŸ¥æœåŠ¡å™¨åœ°å€ï¼ˆå¯é€‰ï¼‰
- `wechat_token`: å¾®ä¿¡é€šçŸ¥Tokenï¼ˆå¯é€‰ï¼‰
- `port`: HTTPæœåŠ¡ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ 8443

### è®¢é˜…æ•°æ®ç»“æ„

è®¢é˜…ä¿¡æ¯ç‹¬ç«‹å­˜å‚¨åœ¨ `subscribes.json` æ–‡ä»¶ä¸­ï¼š

```json
[
  {
    "douban_id": "36391902",
    "name": "åº†ä½™å¹´ ç¬¬äºŒå­£",
    "resolution": 1
  },
  {
    "douban_id": "26798436",
    "name": "ç…çŠæ¦œ",
    "resolution": 0
  }
]
```

- `douban_id`: è±†ç“£ç”µè§†å‰§ID
- `name`: ç”µè§†å‰§åç§°ï¼ˆè‡ªåŠ¨è·å–ï¼‰
- `resolution`: åˆ†è¾¨ç‡ (0=2160P, 1=1080P)

## ğŸ–¥ï¸ ä½¿ç”¨æ–¹æ³•

### Webç•Œé¢ç®¡ç†ï¼ˆæ¨èï¼‰

1. å¯åŠ¨ç¨‹åºï¼š
   ```bash
   ./tvsubscribe
   ```

2. è®¿é—®ç®¡ç†ç•Œé¢ï¼š
   ```
   http://localhost:8443
   ```

3. åœ¨Webç•Œé¢ä¸­ï¼š
   - ğŸ“‹ æŸ¥çœ‹å’Œç®¡ç†è®¢é˜…åˆ—è¡¨
   - âš™ï¸ é…ç½®æœåŠ¡å™¨å‚æ•°
   - ğŸ“Š ç›‘æ§ä¸‹è½½çŠ¶æ€
   - ğŸ”„ å®æ—¶æ›´æ–°é…ç½®

### å‘½ä»¤è¡Œç®¡ç†

```bash
# æŸ¥çœ‹é…ç½®
./tvsubscribe config --list

# è®¾ç½®é…ç½®
./tvsubscribe config --set "endpoint=https://springsunday.net" "interval_minutes=30"

# æŸ¥çœ‹è®¢é˜…
./tvsubscribe subscribe --list

# æ·»åŠ è®¢é˜…
./tvsubscribe subscribe --add "douban_id=36391902" "resolution=1"

# åˆ é™¤è®¢é˜…
./tvsubscribe subscribe --del "douban_id=36391902" "resolution=1"
```

### APIæ¥å£

ç¨‹åºæä¾›å®Œæ•´çš„RESTful APIï¼š

```bash
# è·å–é…ç½®
curl http://localhost:8443/getConfig

# è®¾ç½®é…ç½®
curl -X POST http://localhost:8443/setConfig \
  -H "Content-Type: application/json" \
  -d '{"interval_minutes": 30}'

# è·å–è®¢é˜…åˆ—è¡¨
curl http://localhost:8443/getSubscribeList

# æ·»åŠ è®¢é˜…
curl -X POST http://localhost:8443/addSubscribe \
  -H "Content-Type: application/json" \
  -d '{"douban_id": "36391902", "resolution": 1}'
```

## ğŸ—ï¸ è¿è¡Œæ¨¡å¼

ç¨‹åºå¯åŠ¨åä¼šï¼š

1. **ğŸŒ å¯åŠ¨WebæœåŠ¡å™¨** - åœ¨æŒ‡å®šç«¯å£æä¾›HTTPæœåŠ¡
2. **ğŸ” ç«‹å³æ£€æŸ¥** - æ‰§è¡Œä¸€æ¬¡æ‰€æœ‰è®¢é˜…çš„ç§å­æŸ¥è¯¢
3. **â° å®šæ—¶ä»»åŠ¡** - æŒ‰é…ç½®é—´éš”è‡ªåŠ¨æ£€æŸ¥
4. **ğŸ“¡ å¾®ä¿¡é€šçŸ¥** - æ–°ç§å­ä¸‹è½½æˆåŠŸ/å¤±è´¥æ—¶å‘é€é€šçŸ¥
5. **ğŸ”„ é…ç½®ç›‘å¬** - æ”¯æŒWebç•Œé¢çš„å®æ—¶é…ç½®æ›´æ–°

## ğŸ”§ é«˜çº§é…ç½®

### å¾®ä¿¡é€šçŸ¥é…ç½®

é…ç½®å¾®ä¿¡æœåŠ¡å™¨åï¼Œç³»ç»Ÿä¼šåœ¨ä»¥ä¸‹æƒ…å†µå‘é€é€šçŸ¥ï¼š

- âœ… æ–°ç§å­ä¸‹è½½æˆåŠŸ
- âŒ ç§å­ä¸‹è½½å¤±è´¥
- âš ï¸ ç³»ç»Ÿé”™è¯¯è­¦å‘Š

```json
{
  "wechat_server": "https://your-wechat-bot.com/webhook",
  "wechat_token": "your_secret_token"
}
```

### è·å–Cookie

1. ç™»å½• SpringSunday ç½‘ç«™
2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
3. åˆ·æ–°é¡µé¢ï¼Œåœ¨Networkæ ‡ç­¾ä¸­æ‰¾åˆ°è¯·æ±‚
4. å¤åˆ¶è¯·æ±‚å¤´ä¸­çš„ `Cookie` å€¼

### è·å–è±†ç“£ID

1. è®¿é—®è±†ç“£ç”µè§†å‰§é¡µé¢
2. ä»URLä¸­è·å–IDï¼Œå¦‚ï¼š`https://movie.douban.com/subject/36391902/`
3. è±†ç“£IDå°±æ˜¯ `36391902`

## ğŸ“Š é¡¹ç›®æ¶æ„

```
tvsubscribe/
â”œâ”€â”€ cmd/                    # å‘½ä»¤è¡Œå…¥å£
â”‚   â”œâ”€â”€ main.go            # ä¸»ç¨‹åºå…¥å£
â”‚   â””â”€â”€ cli.go             # CLIå‘½ä»¤å¤„ç†
â”œâ”€â”€ server/                 # HTTPæœåŠ¡å™¨
â”‚   â””â”€â”€ server.go          # Ginè·¯ç”±å’ŒAPI
â”œâ”€â”€ web/                    # Webç®¡ç†ç•Œé¢
â”‚   â”œâ”€â”€ src/               # Vue.jsæºç 
â”‚   â”œâ”€â”€ dist/              # æ„å»ºè¾“å‡º
â”‚   â””â”€â”€ package.json       # å‰ç«¯ä¾èµ–
â”œâ”€â”€ subscribe/              # è®¢é˜…ç®¡ç†
â”‚   â””â”€â”€ manager.go         # è®¢é˜…ç®¡ç†å™¨
â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ config.go          # é…ç½®ç®¡ç†å™¨
â”œâ”€â”€ torrentList.go          # ç§å­æŸ¥è¯¢é€»è¾‘
â”œâ”€â”€ downloadTorrent.go      # ç§å­ä¸‹è½½é€»è¾‘
â””â”€â”€ interfaces.go           # æ¥å£å®šä¹‰
```

## ğŸ› ï¸ å¼€å‘è¯´æ˜

### ç¯å¢ƒè¦æ±‚

- Go 1.19+
- Node.js 16+ (å¼€å‘Webç•Œé¢æ—¶)

### å¼€å‘Webç•Œé¢

```bash
cd web
npm install
npm run dev      # å¼€å‘æœåŠ¡å™¨
npm run build    # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```

### ç¼–è¯‘é¡¹ç›®

```bash
# ç¼–è¯‘ä¸»ç¨‹åº
go build -o tvsubscribe cmd/*.go

# äº¤å‰ç¼–è¯‘
GOOS=linux GOARCH=amd64 go build -o tvsubscribe-linux cmd/*.go
GOOS=windows GOARCH=amd64 go build -o tvsubscribe.exe cmd/*.go
```

## ğŸ“ æ³¨æ„äº‹é¡¹

- ç¡®ä¿ SpringSunday Cookie æœ‰æ•ˆä¸”æœªè¿‡æœŸ
- ç¨‹åºä¼šè‡ªåŠ¨åˆ›å»º `config.json` å’Œ `subscribes.json` æ–‡ä»¶
- ç§å­æ–‡ä»¶é»˜è®¤ä¿å­˜åœ¨ `torrents/` ç›®å½•ä¸‹
- æ”¯æŒé…ç½®çƒ­é‡è½½ï¼Œæ— éœ€é‡å¯ç¨‹åº
- ä½¿ç”¨ `Ctrl+C` ä¼˜é›…é€€å‡ºç¨‹åº

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥å®Œå–„è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“„ è®¸å¯è¯

MIT License